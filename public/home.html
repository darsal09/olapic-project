<!DOCTYPE html>
<html>
<title>W3.CSS Template</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/lib/w3.css">
<link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Roboto'>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://www.w3schools.com/lib/w3.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

<style>
    html,body,h1,h2,h3,h4,h5,h6 {font-family: "Roboto", sans-serif}
</style>
<body class="w3-light-grey">
<header class="w3-container w3-teal w3-center w3-margin-top">
   <h2>Olapic App</h2>
</header>

<!-- Page Container -->
<div class="w3-content w3-margin-top" style="max-width:1400px;">

    <!-- The Grid -->
    <div class="w3-row-padding">

        <!-- Left Column -->
        <div class="w3-third">
            <div class="w3-white w3-text-grey w3-card-4">
                <div class="w3-container">
                        <h2>Customers</h2>
                </div>
                <div class="w3-container">
                    <input oninput="w3.filterHTML('#customers', 'li', this.value)" placeholder="Search for names..">
                    <ul id="customers">
                        <!--<li w3-repeat="customers" class="customers" data-id="{{id}}">{{name}}</a></li> -->
                    </ul>

                </div>
            </div><br>

            <!-- End Left Column -->
        </div>

        <!-- Right Column -->
        <div class="w3-twothird">
            <div class="w3-container w3-card-2 w3-white">
                <h2 class="w3-text-grey w3-padding-16">Customer Images will show below</h2>
                <div class="w3-container" id="images">
                </div>
            </div>

            <!-- End Right Column -->
        </div>

        <!-- End Grid -->
    </div>

    <!-- End Page Container -->
</div>

<footer class="w3-container w3-teal w3-center w3-margin-top">
    <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank">w3.css</a></p>
</footer>

</body>
</html>
<script>
  //  w3.getHttpObject("/customers", myFunction);


/*
    function myFunction(myObject) {
        w3.displayObject("id01", myObject);
    }
*/

    var customers = {
        init:function(){
            this.loadCustomers();
           // this.events();
        },
        events:function(){
           $( 'ul#customers li').on( 'click', this.loadCustomerImages );
        },
        loadCustomerImages:function(){
            var id =  $( this).attr( 'data-id');
            var url = '/customers/'+id;
            $.ajax({
                url:url,
                method:'GET',
                dataType:'json'
            }).done(function( data){
                    $( 'div#images').html( '' );
                    var images = data.customer.images;
                    for( x in images ){
                        $('div#images').append( $( '<div></div>').append( '<image src="'+images[ x].name+'">'));
                    }
            }).fail();
        },
        loadCustomer:function(){
            var that = this;

            $.ajax({
                url:'/',
                method:'GET',
                dataType: 'json'
            }).done( function(  data ){
                var customers = data.customers;
                for( x in data.customers ){
                    $( 'ul#customers').append($( '<li>' ).text( customers[x].name).attr( 'data-id', customers[ x].id) );
                }
                that.events();
            } ).fail();
        }
    }

    $(function(){
        customers.init();
    });
</script>
